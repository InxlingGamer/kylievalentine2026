<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For My Bunny</title>
    
    <!-- 1. Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Google Fonts: Nunito for a round, cute look -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    
    <!-- 3. GSAP for Scroll Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <!-- 4. Confetti for the finale (Updated to 1.9.2 for better shape support) -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

    <style>
        /* RESET & BASICS */
        html {
            /* Fix for top notch/status bar area showing white on overscroll */
            background-color: #e0f2fe;
            overflow-x: hidden;
        }

        body {
            margin: 0;
            padding: 0;
            width: 100%;
            /* IMPORTANT: Removed height: 100% to allow proper scrolling */
            min-height: 100vh; 
            overflow-x: hidden;
            /* Fix for bottom overscroll area */
            background-color: #fce7f3; 
        }

        /* FIX: Fixed Background Element
           1. height: 100vh covers the visual viewport
           2. -webkit-fill-available ensures it respects iOS address bar dynamics
        */
        .fixed-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh; 
            height: -webkit-fill-available; 
            background: linear-gradient(180deg, #e0f2fe 0%, #dcfce7 40%, #fce7f3 100%);
            z-index: -50; 
            will-change: transform;
        }

        /* Hide scrollbar for cleaner look */
        ::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }

        .bunny-container {
            position: fixed;
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 50;
            pointer-events: none; /* Let clicks pass through bunny so you can scroll */
            will-change: transform;
        }

        .bunny-body {
            animation: bounce 0.6s infinite alternate ease-in-out;
        }

        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }

        .clouds-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0; 
        }

        .cloud {
            opacity: 0.8;
            position: absolute;
            animation: floatCloud 20s linear infinite;
        }

        @keyframes floatCloud {
            from { transform: translateX(-100%); }
            to { transform: translateX(100vw); }
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(5px);
            border-radius: 20px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            position: relative; 
            z-index: 10;
        }

        .photo-frame {
            width: 100%;
            height: 250px;
            background-color: #e5e7eb;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 4px solid white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .photo-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* The hidden heart popup */
        #proposal-popup, #countdown-popup {
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: scale(0);
            opacity: 0;
        }
        
        #proposal-popup.active, #countdown-popup.active {
            transform: scale(1);
            opacity: 1;
        }

        .tap-hint {
            animation: pulse 2s infinite;
        }

        .path-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1; 
            overflow: hidden;
        }
        
        .timer-box {
            background: #fce7f3;
            border-radius: 12px;
            padding: 10px;
            width: 70px;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- FIXED BACKGROUND LAYER -->
    <div class="fixed-bg"></div>

    <!-- BACKGROUND CLOUDS -->
    <div class="clouds-container">
        <!-- Cloud 1 -->
        <svg class="cloud" style="top: 10%; width: 100px; animation-duration: 25s;" viewBox="0 0 24 24" fill="white"><path d="M18.5,12c-0.3,0-0.6,0.1-0.9,0.1C17.2,10.2,15.3,9,13,9c-2.8,0-5.1,1.8-6,4.3C6.7,13.1,6.4,13,6,13c-2.2,0-4,1.8-4,4 s1.8,4,4,4h12.5c2.5,0,4.5-2,4.5-4.5S21,12,18.5,12z"/></svg>
        <!-- Cloud 2 -->
        <svg class="cloud" style="top: 30%; width: 80px; animation-duration: 35s; animation-delay: -10s;" viewBox="0 0 24 24" fill="white"><path d="M18.5,12c-0.3,0-0.6,0.1-0.9,0.1C17.2,10.2,15.3,9,13,9c-2.8,0-5.1,1.8-6,4.3C6.7,13.1,6.4,13,6,13c-2.2,0-4,1.8-4,4 s1.8,4,4,4h12.5c2.5,0,4.5-2,4.5-4.5S21,12,18.5,12z"/></svg>
    </div>

    <!-- THE BUNNY (Fixed Character) -->
    <div class="bunny-container">
        <svg width="100" height="120" viewBox="0 0 100 120" class="bunny-body">
            <!-- Ears -->
            <path d="M30 40 Q20 0 40 10" fill="#fff" stroke="#f3f4f6" stroke-width="2"/>
            <path d="M35 35 Q28 10 38 15" fill="#fbcfe8"/> <!-- Inner Ear L -->
            <path d="M70 40 Q80 0 60 10" fill="#fff" stroke="#f3f4f6" stroke-width="2"/>
            <path d="M65 35 Q72 10 62 15" fill="#fbcfe8"/> <!-- Inner Ear R -->
            
            <!-- Head -->
            <circle cx="50" cy="55" r="35" fill="#fff" stroke="#f3f4f6" stroke-width="2"/>
            
            <!-- Eyes -->
            <circle cx="40" cy="50" r="3" fill="#1f2937"/>
            <circle cx="60" cy="50" r="3" fill="#1f2937"/>
            
            <!-- Cheeks -->
            <circle cx="35" cy="60" r="4" fill="#fbcfe8" opacity="0.6"/>
            <circle cx="65" cy="60" r="4" fill="#fbcfe8" opacity="0.6"/>
            
            <!-- Nose/Mouth -->
            <path d="M48 58 Q50 60 52 58" fill="none" stroke="#db2777" stroke-width="2" stroke-linecap="round"/>
            <path d="M50 60 L50 65" fill="none" stroke="#db2777" stroke-width="2" stroke-linecap="round"/>
            
            <!-- Body -->
            <path d="M30 80 Q20 110 50 110 Q80 110 70 80" fill="#fff" stroke="#f3f4f6" stroke-width="2"/>
            
            <!-- Paws -->
            <ellipse cx="40" cy="85" rx="6" ry="4" fill="#fff" stroke="#e5e7eb"/>
            <ellipse cx="60" cy="85" rx="6" ry="4" fill="#fff" stroke="#e5e7eb"/>
        </svg>
        <div class="text-center mt-2 bg-white/80 backdrop-blur-sm px-3 py-1 rounded-full text-xs font-bold text-pink-500 shadow-sm border border-pink-100">
            Keep scrolling!
        </div>
    </div>

    <!-- MAIN SCROLL CONTENT -->
    <!-- Changed pb-96 to pb-10 to reduce bottom scroll space -->
    <main class="relative z-10 pb-10">
        
        <!-- WINDING DIRT PATH SVG -->
        <div class="path-container">
            <svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                <!-- Outer Path (Lighter Sand Color) -->
                <path d="M50,-5 C 30,15 70,25 50,40 C 30,55 70,65 50,80 C 30,90 70,95 50,105" 
                      stroke="#e7c8a0" 
                      stroke-width="5" 
                      fill="none" />
                <!-- Inner Path (Dotted texture) -->
                <path d="M50,-5 C 30,15 70,25 50,40 C 30,55 70,65 50,80 C 30,90 70,95 50,105" 
                      stroke="#d6a65c" 
                      stroke-width="1.5" 
                      stroke-dasharray="2 2"
                      fill="none" />
            </svg>
        </div>

        <!-- SECTION 1: INTRO -->
        <div class="h-screen flex items-start justify-center pt-20 px-6 section">
            <div class="card p-8 text-center max-w-sm fade-in-up">
                <h1 class="text-3xl font-extrabold text-pink-500 mb-4">Hi Bunny! üê∞</h1>
                <p class="text-gray-600 text-lg leading-relaxed">
                    I made a little something for you. <br>
                    Follow the bunny down the path...
                </p>
                <div class="mt-6 text-pink-400 animate-bounce">
                    ‚Üì
                </div>
            </div>
        </div>

        <!-- SECTION 2: MEMORY 1 (Text + Photo) -->
        <div class="h-screen flex items-center justify-center px-6 section">
            <div class="card p-6 w-full max-w-sm fade-in-up">
                <!-- CUSTOMIZATION: Change this text -->
                <p class="text-pink-500 font-bold mb-3">Do you remember...</p>
                
                <!-- CUSTOMIZATION: Add your image URL in the src below -->
                <div class="photo-frame mb-4">
                     <!-- Example using a placeholder service. Replace src with your image file path -->
                    <img src="https://placehold.co/400x300/pink/white?text=Our+First+Date" alt="Memory 1">
                </div>

                <p class="text-gray-600 text-sm">
                    When we went on our first date? I knew right then that you were special.
                </p>
            </div>
        </div>

        <!-- SECTION 3: REASON WHY (Text only) -->
        <div class="h-screen flex items-center justify-center px-6 section">
            <div class="card p-8 w-full max-w-sm text-center fade-in-up">
                <div class="text-4xl mb-4">‚ú®</div>
                <h2 class="text-2xl font-bold text-gray-800 mb-4">You make life better.</h2>
                <p class="text-gray-600">
                    Your smile is my favorite thing in the world. Being your "bunny" makes me the happiest person alive.
                </p>
            </div>
        </div>

        <!-- SECTION 4: MEMORY 2 -->
        <div class="h-screen flex items-center justify-center px-6 section">
            <div class="card p-6 w-full max-w-sm fade-in-up">
                 <!-- CUSTOMIZATION: Change this text -->
                <p class="text-pink-500 font-bold mb-3">And that time when...</p>
                
                 <!-- CUSTOMIZATION: Add your image URL in the src below -->
                <div class="photo-frame mb-4">
                    <img src="https://placehold.co/400x300/pink/white?text=Funny+Moment" alt="Memory 2">
                </div>

                <p class="text-gray-600 text-sm">
                    We couldn't stop laughing at that silly thing? I love those moments with you.
                </p>
            </div>
        </div>

        <!-- SECTION 5: THE ASK (Carrot House) -->
        <div class="h-screen flex flex-col items-center justify-center px-6 section relative">
            
            <!-- The "House" / Goal -->
            <div id="mailbox-trigger" class="cursor-pointer transform transition-transform hover:scale-105 active:scale-95 mb-8 fade-in-up w-full">
                <!-- Replaced SVG with your image -->
                <!-- REMOVED max-w constraints and added min-w to force size -->
                <img src="bunnyhearthouse.png" alt="Bunny Heart House" class="w-full h-auto mx-auto drop-shadow-2xl min-w-[300px]">
                
                <div class="text-center mt-4 bg-white px-4 py-2 rounded-full shadow-lg tap-hint w-max mx-auto">
                    <span class="text-pink-500 font-bold">Tap the House!</span>
                </div>
            </div>

        </div>
    </main>

    <!-- 1. PROPOSAL POPUP OVERLAY -->
    <div id="proposal-popup" class="fixed inset-0 bg-black/60 z-[100] flex items-center justify-center px-6 pointer-events-none">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl pointer-events-auto relative overflow-hidden">
            <!-- Decorative background hearts -->
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-pink-300 to-red-400"></div>
            
            <h2 class="text-3xl font-black text-pink-600 mb-2">My Dearest Bunny,</h2>
            <p class="text-gray-600 mb-8 mt-4 text-lg">
                I have one important question...
            </p>
            
            <div class="text-2xl font-bold text-gray-800 mb-8 leading-tight">
                Will you be my Valentine?
            </div>

            <div class="space-y-3">
                <button onclick="acceptProposal()" class="w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-4 rounded-xl shadow-lg transform transition active:scale-95 text-xl">
                    YES! üê∞‚ù§Ô∏è
                </button>
                <button onclick="acceptProposal()" class="w-full bg-pink-100 hover:bg-pink-200 text-pink-600 font-bold py-3 rounded-xl transform transition active:scale-95">
                    Of course!
                </button>
            </div>
        </div>
    </div>

    <!-- 2. COUNTDOWN POPUP OVERLAY (Hidden initially) -->
    <div id="countdown-popup" class="fixed inset-0 bg-black/60 z-[100] flex items-center justify-center px-6 pointer-events-none">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl pointer-events-auto relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-green-300 to-blue-400"></div>
            
            <h2 class="text-2xl font-black text-pink-600 mb-2">See you soon! üê∞</h2>
            <p class="text-gray-600 mb-6 text-md">
                Counting down the seconds until our date...
            </p>
            
            <!-- Timer Grid -->
            <div class="flex justify-center gap-2 mb-6">
                <div class="timer-box">
                    <div id="d-val" class="text-2xl font-bold text-gray-800">0</div>
                    <div class="text-xs text-gray-500 uppercase">Days</div>
                </div>
                <div class="timer-box">
                    <div id="h-val" class="text-2xl font-bold text-gray-800">0</div>
                    <div class="text-xs text-gray-500 uppercase">Hours</div>
                </div>
                <div class="timer-box">
                    <div id="m-val" class="text-2xl font-bold text-gray-800">0</div>
                    <div class="text-xs text-gray-500 uppercase">Mins</div>
                </div>
                <div class="timer-box">
                    <div id="s-val" class="text-2xl font-bold text-gray-800">0</div>
                    <div class="text-xs text-gray-500 uppercase">Secs</div>
                </div>
            </div>

            <div class="text-pink-400 text-sm font-bold">
                Feb 14th ‚ù§Ô∏è
            </div>
        </div>
    </div>

    <script>
        // 1. REGISTER GSAP
        gsap.registerPlugin(ScrollTrigger);

        // Wait for DOM to be ready
        window.addEventListener("load", () => {
            
            // Define Heart Shape for Confetti
            var heart = confetti.shapeFromPath({
                path: 'M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z'
            });

            // 2. ANIMATE SECTIONS ON SCROLL
            gsap.utils.toArray('.fade-in-up').forEach((elem) => {
                gsap.from(elem, {
                    scrollTrigger: {
                        trigger: elem,
                        start: "top 85%", 
                        end: "bottom 20%",
                        toggleActions: "play none none reverse"
                    },
                    y: 50,
                    opacity: 0,
                    duration: 1,
                    ease: "power2.out"
                });
            });

            ScrollTrigger.refresh();

            // 3. FINAL INTERACTION
            const mailbox = document.getElementById('mailbox-trigger');
            const proposalPopup = document.getElementById('proposal-popup');
            const countdownPopup = document.getElementById('countdown-popup');
            const bunnyContainer = document.querySelector('.bunny-container');

            mailbox.addEventListener('click', () => {
                // Hide the bunny to focus on popup
                gsap.to(bunnyContainer, { opacity: 0, duration: 0.5 });
                
                // Show proposal popup
                proposalPopup.classList.add('active');
                
                // First burst of small confetti (HEARTS!)
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#ec4899', '#a855f7', '#ef4444', '#ffffff'], // Pink, Purple, Red, White
                    shapes: [heart],
                    scalar: 2 // Make hearts a bit bigger
                });
            });

            // 4. ACCEPT PROPOSAL FUNCTION
            window.acceptProposal = function() {
                // Massive confetti explosion
                const duration = 15 * 1000;
                const animationEnd = Date.now() + duration;
                // Added colors to defaults
                const defaults = { 
                    startVelocity: 30, 
                    spread: 360, 
                    ticks: 60, 
                    zIndex: 200, 
                    shapes: [heart], 
                    scalar: 2,
                    colors: ['#ec4899', '#a855f7', '#ef4444', '#ffffff'] // Pink, Purple, Red, White
                };

                function randomInRange(min, max) {
                    return Math.random() * (max - min) + min;
                }

                const interval = setInterval(function() {
                    const timeLeft = animationEnd - Date.now();
                    if (timeLeft <= 0) return clearInterval(interval);
                    const particleCount = 50 * (timeLeft / duration);
                    confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                    confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
                }, 250);

                // Change button text
                const btns = document.querySelectorAll('button');
                btns[0].textContent = "YAY!!! I LOVE YOU! ‚ù§Ô∏è";
                btns[0].classList.replace('bg-pink-500', 'bg-green-500');
                btns[1].style.display = 'none';

                // 5. SWITCH TO COUNTDOWN AFTER 3 SECONDS
                setTimeout(() => {
                    // Fade out proposal
                    proposalPopup.classList.remove('active');
                    
                    // Wait small moment, fade in countdown
                    setTimeout(() => {
                        startCountdown();
                        countdownPopup.classList.add('active');
                        // More confetti because why not
                        confetti({ 
                            particleCount: 100, 
                            spread: 100, 
                            origin: { y: 0.6 },
                            shapes: [heart],
                            scalar: 2,
                            colors: ['#ec4899', '#a855f7', '#ef4444', '#ffffff'] // Pink, Purple, Red, White
                        });
                    }, 500);
                }, 3000);
            }
        });

        // 6. COUNTDOWN LOGIC
        function startCountdown() {
            function updateTimer() {
                const now = new Date();
                let year = now.getFullYear();
                // Month is 0-indexed (0 = Jan, 1 = Feb)
                let valentine = new Date(year, 1, 14, 0, 0, 0); 

                // If Feb 14 has passed this year, count to next year
                if (now > valentine) {
                    valentine = new Date(year + 1, 1, 14, 0, 0, 0);
                }

                const diff = valentine - now;

                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((diff % (1000 * 60)) / 1000);

                document.getElementById('d-val').innerText = d;
                document.getElementById('h-val').innerText = h;
                document.getElementById('m-val').innerText = m;
                document.getElementById('s-val').innerText = s;
            }

            updateTimer(); // run immediately
            setInterval(updateTimer, 1000); // run every second
        }
    </script>
</body>
</html>